apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: prod
resources:
  - ../../base
nameSuffix: -prod

images:
  - name: nginx:alpine
    newName: nginx
    newTag: 1.25-alpine

patches:
  - target:
      kind: Ingress
      name: app
    patch: |-
      - op: replace
        path: /spec/rules/0/host
        value: hello.prod.local

  - target:
      kind: ConfigMap
      name: nginx-html-content
    patch: |-
      - op: replace
        path: /data/index.html
        value: |
          <!DOCTYPE html>
          <html lang="en">
          <head>
              <meta charset="UTF-8">
              <meta name="viewport" content="width=device-width, initial-scale=1.0">
              <title>Custom Nginx Page - PROD</title>
          </head>
          <body bgcolor="green">
            <div style="display:flex; flex-direction:column; justify-content:center; align-items:center; height:100vh;">
              <h1>ðŸš€ PROD Environment ðŸš€</h1>
              <p>This page is served from <b>PROD</b> Kubernetes environment.</p>
              <p>Current Time: <span id="current-time"></span></p>
            </div>
            <script>
              document.getElementById("current-time").textContent = new Date().toLocaleString();
            </script>
          </body>
          </html>
      
      
